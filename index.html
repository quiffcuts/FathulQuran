<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- === KEYWORDS AUR DESCRIPTION UPDATE KAR DIYE HAIN === -->
    <meta name="description" content="Madarsa Fathul Quran - ek Islami taleemi idara hai jo bachon aur baron ko Quran-e-Kareem ki saheeh taleem dene ke liye qaim kiya gaya hai. Hamara bunyadi maqsad sirf lafzon ko parhana nahi, balke Quran ke paigham aur uske gehre mafhoom (matlab) ko samjhana hai. Hum Nazra, Hifz-ul-Quran, aur Tajweed ke sath sath bunyadi Islami taleemat par bhi tawajjo dete hain taake ek behtar Musalman aur insan tayyar ho sakein!">
    <meta name="keywords" content="Madrasa near me, Quran academy near me, Best madrasa in Faisalabad, Islamic center Faisalabad, Madrasa in Mansoorabad Faisalabad, Madrasa dakhla, Bachon ke liye Quran ki taleem, How to learn Quran reading, Hifz e Quran admission, Quranic education center, Qari sahab ka number, بچوں کے لیے دینی تعلیم, Quran classes for kids">
    <title>Madarsa Fathul Quran in Faisalabad</title>

    <!-- === WEBSITE KA FAVICON (TAB ICON) === -->
    <!-- Updated favicon link for better display, though resolution depends on source image -->
    <link rel="icon" type="image/png" href="https://i.postimg.cc/W17FxMYK/icon.png" sizes="512x512">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;1,600&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <!-- Arabic Font for Quranic Verse -->
    <link href="https://fonts.googleapis.com/css2?family=Scheherazade+New:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Elfsight Google Reviews Widget Script (agar zaroorat na ho toh hata sakte hain) -->
    <script src="https://static.elfsight.com/platform/platform.js" data-use-service-core defer></script>

    <!-- HTML2Canvas Libraries (if needed for other features) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <!-- === LOCAL SEO KE LIYE SCHEMA MARKUP UPDATE KAR DIYA HAI === -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "EducationalOrganization",
      "name": "Madarsa Fathul Quran",
      "description": "Madarsa Fathul Quran - ek Islami taleemi idara hai jo bachon aur baron ko Quran-e-Kareem ki saheeh taleem dene ke liye qaim kiya gaya hai. Hamara bunyadi maqsad sirf lafzon ko parhana nahi, balke Quran ke paigham aur uske gehre mafhoom (matlab) ko samjhana hai. Hum Nazra, Hifz-ul-Quran, aur Tajweed ke sath sath bunyadi Islami taleemat par bhi tawajjo dete hain taake ek behtar Musalman aur insan tayyar ho sakein!",
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "Madrasa Fathul Quran Mansoor Abad nazad Imam Bargah",
        "addressLocality": "Faisalabad",
        "addressCountry": "PK"
      },
      "telephone": "+923346541364",
      "url": "https://www.madarsafathulquran.com",  <!-- Apni Madarsa website ka poora URL daalein -->
      "image": "https://i.postimg.cc/13WNf0K7/Adobe-Express-file-2.png",
      "openingHours": "Mo-Sa 08:00-18:00", <!-- Madarsa ke auqaat-e-kar (timings) yahan likhein -->
      "alumni": [
        {
          "@type": "Person",
          "name": "Hazrat Maulana Tariq Jameel"
        },
        {
          "@type": "Person",
          "name": "Mufti Muhammad Taqi Usmani"
        }
      ]
    }
    </script>

    <!-- Firebase SDK - Start -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
      import { getFirestore, collection, addDoc, getDocs, query, deleteDoc, doc, orderBy } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
      import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js"; 

      const firebaseConfig = {
        apiKey: "AIzaSyAR83yCzvSKS9HblZCjN6h6SlDxa6Cdpho",
        authDomain: "fathul-quran.firebaseapp.com",
        projectId: "fathul-quran",
        storageBucket: "fathul-quran.firebasestorage.app", 
        messagingSenderId: "607879637805",
        appId: "1:607879637805:web:fbe5917128bfc7b51f41a4",
        measurementId: "G-KRXWQDX5NM"
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const dbInstance = getFirestore(app);
      const authInstance = getAuth(app); // Initialize Auth

      // Make Firebase instances and core functions globally accessible
      window.firebaseApp = app;
      window.firebaseFirestore = dbInstance;
      window.firebaseAuth = authInstance; // Expose Auth instance
      // Auth functions
      window.firebaseSignInWithEmailAndPassword = signInWithEmailAndPassword;
      window.firebaseSignOut = signOut;
      window.firebaseOnAuthStateChanged = onAuthStateChanged;
      // Firestore functions
      window.firebaseFirestore.addDoc = addDoc;
      window.firebaseFirestore.collection = collection;
      window.firebaseFirestore.getDocs = getDocs;
      window.firebaseFirestore.query = query;
      window.firebaseFirestore.deleteDoc = deleteDoc;
      window.firebaseFirestore.doc = doc;
      window.firebaseFirestore.orderBy = orderBy; // Expose orderBy
    </script>
    <!-- Firebase SDK - End -->

    <style>
        /* CSS Variables for easy color management */
        :root {
            --gold: #C5B358;
            --black: #0a0a0a;
            --dark-gray: #111111;
            --text-light: #e0e0e0;
            --text-dark: #a0a0a0;
            --white: #ffffff;
        }

        @keyframes animateBackground {
            0% { background-position: 50% 0%; }
            50% { background-position: 50% 100%; }
            100% { background-position: 50% 0%; }
        }

        body {
            background: linear-gradient(180deg, var(--black) 30%, var(--gold) 50%, var(--black) 70%);
            background-size: 100% 300%;
            animation: animateBackground 25s ease-in-out infinite;
            color: var(--text-light);
            font-family: 'Poppins', sans-serif;
        }
        
        .font-playfair { font-family: 'Playfair Display', serif; }
        .text-gold-gradient {
            background: linear-gradient(135deg, #E6C66E, var(--gold), #b59f3b);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .text-gold { color: var(--gold); }

        .btn-primary {
            background-color: var(--gold);
            color: var(--black);
            font-weight: 600;
            padding: 12px 32px;
            border-radius: 50px;
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: 0 4px 15px rgba(197, 179, 88, 0.2);
            border: 2px solid var(--gold);
        }
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(197, 179, 88, 0.3);
            background-color: transparent;
            color: var(--gold);
        }
        
        .btn-secondary {
            background-color: transparent;
            color: var(--gold);
            font-weight: 600;
            padding: 10px 28px;
            border-radius: 50px;
            transition: all 0.3s ease;
            border: 2px solid var(--gold);
        }
        .btn-secondary:hover {
            background-color: var(--gold);
            color: var(--black);
        }

        .hero-section {
            background-size: cover;
            background-position: center 30%;
            position: relative;
            overflow: hidden;
            transition: background-image 1.5s ease-in-out;
        }
        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 10, 10, 0.5);
            z-index: 1;
        }
        .hero-content { position: relative; z-index: 2; }

        /* Adjusted glass-card to be used for activities section as well */
        .glass-card {
            background: rgba(17, 17, 17, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        .glass-card:hover {
            border-color: var(--gold); /* Gold border on hover */
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(197, 179, 88, 0.2); /* Gold-tinted shadow on hover */
        }
        
        .fade-in-section {
            opacity: 0;
            transform: translateY(40px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .fade-in-section.is-visible { opacity: 1; transform: translateY(0); }
        
        .title-underline { position: relative; padding-bottom: 10px; }
        .title-underline::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background: var(--gold);
            border-radius: 2px;
        }
        
        .about-slideshow-frame {
            padding: 10px;
            border: 1px solid #333;
            border-radius: 12px;
            background-color: var(--black);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            width: 100%;
            max-width: 350px;
            transition: border-color 0.5s ease;
        }
        .about-slideshow-frame:hover { border-color: var(--gold); }
        #about-slideshow-container {
            overflow: hidden;
            border-radius: 0.5rem;
            position: relative;
            height: 480px;
            width: 100%;
        }
        .about-slide-wrapper {
             position: absolute;
             top: 0;
             left: 0;
             width: 100%;
             height: 100%;
             opacity: 0;
             transition: opacity 1.5s ease-in-out;
        }
        .about-slide-wrapper.active { opacity: 1; }
        .about-slide {
            width: 100%;
            height: 100%;
            object-fit: cover;
            /*filter: grayscale(100%) brightness(0.7);
            transition: filter 0.5s ease-in-out;*/
        }
        .about-slideshow-frame:hover .about-slide-wrapper.active .about-slide {
            filter: grayscale(0) brightness(2);
        }

        /* --- Gallery Styles --- */
        .gallery-card {
            position: relative;
            padding: 8px;
            border: 1px solid #333;
            border-radius: 12px;
            background-color: var(--black);
            box-shadow: 0 10px 20px rgba(0,0,0,0.4);
            transition: all 0.4s ease;
            overflow: hidden;
        }
        .gallery-card:hover {
            border-color: var(--gold);
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.5);
        }
        .gallery-img-container {
            overflow: hidden;
            border-radius: 0.5rem;
            aspect-ratio: 3 / 4;
        }
        .gallery-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        .gallery-card:hover .gallery-img {
            transform: scale(1.1);
        }
        
        .filter-btn {
            padding: 8px 20px;
            border: 1px solid var(--text-dark);
            border-radius: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .filter-btn:hover, .filter-btn.active {
            background-color: var(--gold);
            color: var(--black);
            border-color: var(--gold);
            font-weight: 600;
        }
        .gallery-item {
            transition: transform 0.3s ease, opacity 0.3s ease;
            position: relative;
        }
        .gallery-item.hidden {
            transform: scale(0.8);
            opacity: 0;
            width: 0;
            height: 0;
            padding: 0;
            margin: 0;
            overflow: hidden;
        }
        
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: flex; justify-content: center; align-items: center;
            z-index: 100; opacity: 0; pointer-events: none; transition: opacity 0.3s ease;
        }
        .modal-overlay.visible { opacity: 1; pointer-events: auto; }
        .modal-content {
            background-color: var(--dark-gray);
            padding: 2rem; border-radius: 10px; border: 1px solid var(--gold);
            width: 90%; max-width: 500px;
            transform: scale(0.95); transition: transform 0.3s ease;
            max-height: 90vh;
            overflow-y: auto;
        }
        .modal-overlay.visible .modal-content { transform: scale(1); }
        .modal-content input, .modal-content select, .modal-content textarea {
            background-color: var(--black);
            border: 1px solid var(--text-dark);
            color: var(--text-light);
            width: 100%; padding: 12px; border-radius: 5px;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        .modal-content input:focus, .modal-content select:focus, .modal-content textarea:focus {
            outline: none;
            border-color: var(--gold);
            box-shadow: 0 0 0 2px rgba(197, 179, 88, 0.3);
        }
        
        /* Removed Custom Time Picker Styles */
        /* Removed Booking Pass Styles */

        .elfsight-app-cc6dedf0-59f2-4afb-bb5a-ac06091e73ea a[href*="elfsight.com"] { display: none !important; }
        
        .delete-icon {
            position: absolute; top: 15px; right: 15px;
            background-color: rgba(239, 68, 68, 0.8);
            color: white; width: 30px; height: 30px; border-radius: 50%;
            display: none; justify-content: center; align-items: center;
            cursor: pointer; z-index: 10; transition: background-color 0.3s;
        }
        .delete-icon:hover { background-color: rgba(220, 38, 38, 1); }
        body.delete-mode .delete-icon { display: flex; }
        #finish-managing-btn {
            position: fixed; top: 100px; right: 20px; z-index: 101;
        }

        /* Updated styles for the donation/programs sections */
        .support-box {
            background: rgba(17, 17, 17, 0.7); /* Transparent effect */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-light); /* Text color for readability */
            border-radius: 0.5rem;
            padding: 1.5rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .support-box .raised-amount {
            color: var(--gold); /* Gold color for the amount */
            font-weight: bold;
        }
        .support-box img {
            border-color: var(--gold); /* Gold border for the image */
        }
        .program-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 0.5rem;
        }
        .program-item i {
            color: var(--gold); /* Gold checkmark icon */
        }
        
        /* Our Vision/Mission Icons */
        .vision-mission-icon {
            color: var(--gold); /* Gold color for vision/mission icons */
        }

        /* --- Donation / Quranic Verse Section Specific Styles --- */
        .bg-custom-gold {
            background-color: var(--gold);
        }
        .font-arabic {
            font-family: 'Scheherazade New', serif;
            direction: rtl; /* For right-to-left text */
        }
        .btn-donate-now {
            background-color: var(--white); /* White button as per screenshot */
            color: var(--black);
            font-weight: 600;
            padding: 12px 32px;
            border-radius: 50px;
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            border: 2px solid var(--white);
        }
        .btn-donate-now:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            background-color: transparent;
            color: var(--black); /* Text can stay black or turn gold based on preference */
            border-color: var(--black); /* Border color on hover */
        }

        /* --- Our Team Section Styles --- */
        .team-card {
            background: rgba(17, 17, 17, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .team-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 30px rgba(197, 179, 88, 0.25);
            border-color: var(--gold);
        }
        .team-card img {
            transition: transform 0.4s ease;
        }
        .team-card:hover img {
            transform: scale(1.05);
        }
        
        /* --- Blog Section Styles --- */
        .blog-card {
            background: rgba(17, 17, 17, 0.7);
            border-radius: 0.5rem;
            overflow: hidden;
            transition: all 0.4s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
            position: relative; /* Added for delete icon positioning */
        }
        .blog-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 30px rgba(197, 179, 88, 0.25);
            border-color: var(--gold);
        }
        .blog-card-img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            transition: transform 0.4s ease;
        }
        .blog-card:hover .blog-card-img {
            transform: scale(1.05);
        }
        .blog-card-content {
            padding: 1.5rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        .blog-card-title {
            font-family: 'Playfair Display', serif;
            color: var(--text-light);
        }
        .blog-card-excerpt {
            color: var(--text-dark);
            flex-grow: 1;
            line-height: 1.6;
            -webkit-line-clamp: 3;
            display: -webkit-box;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        /* Styles for Blog Post Modal */
        #blog-post-modal .modal-content {
            max-width: 800px;
        }
        #blog-post-modal-image {
            width: 100%;
            max-height: 400px;
            object-fit: cover;
            border-radius: 0.5rem;
            border: 2px solid var(--gold);
        }
        #blog-post-modal-content {
            line-height: 1.8;
            white-space: pre-wrap; /* Preserves whitespace and newlines */
        }
    </style>
</head>
<body class="bg-black">

    <!-- Finish Managing Button (Initially Hidden for non-admin) -->
    <button id="finish-managing-btn" class="hidden btn-primary bg-red-600 border-red-600 hover:bg-transparent hover:text-red-500">
        <i class="fas fa-check mr-2"></i> Finish Managing
    </button>

    <!-- Header / Navbar -->
    <header class="bg-black/70 backdrop-blur-md p-4 sticky top-0 z-50 border-b border-white/10">
        <div class="container mx-auto flex justify-between items-center">
            <a href="#" class="flex items-center gap-2">
                <!-- Increased logo size to h-20 -->
                <img src="https://i.postimg.cc/6Qvsy0sb/icon.png" alt="Madarsa Fathul Quran Logo" class="h-20">
                <span class="text-2xl font-playfair text-gold-gradient inline">Madarsa Fathul Quran</span>
            </a>
            <nav class="hidden md:flex space-x-8 text-sm font-medium tracking-wider">
                <a href="#about" class="hover:text-gold transition">ABOUT</a>
                <a href="#activities" class="hover:text-gold transition">ACTIVITIES</a>
                <a href="#team" class="hover:text-gold transition">OUR TEAM</a>
                <a href="#customer-gallery" class="hover:text-gold transition">GALLERY</a>
                <a href="#blog" class="hover:text-gold transition">BLOG</a>
                <a href="#contact-call-us" class="hover:text-gold transition">CONTACT</a> <!-- Updated to scroll to Call Us -->
            </nav>
            <button id="donate-now-header-btn" class="btn-primary hidden md:inline-block">Donate Now</button> <!-- Changed to button to open modal -->
            <button id="mobile-menu-btn" class="md:hidden text-2xl text-gold">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden mt-4 text-center">
             <a href="#about" class="block py-2 hover:text-gold transition">ABOUT</a>
             <a href="#activities" class="block py-2 hover:text-gold transition">ACTIVITIES</a>
             <a href="#team" class="block py-2 hover:text-gold transition">OUR TEAM</a>
             <a href="#customer-gallery" class="block py-2 hover:text-gold transition">GALLERY</a>
             <a href="#blog" class="block py-2 hover:text-gold transition">BLOG</a>
             <a href="#contact-call-us" class="block py-2 hover:text-gold transition">CONTACT</a> <!-- Updated to scroll to Call Us -->
             <button id="donate-now-mobile-btn" class="btn-primary mt-4 inline-block">Donate Now</button> <!-- Changed to button to open modal -->
        </div>
    </header>

    <!-- Main Content Sections -->
    <main id="main-content">
        <!-- Hero Section -->
        <section class="hero-section min-h-screen flex items-center justify-center text-center p-4">
            <div class="hero-content container mx-auto">
                <h1 class="text-5xl md:text-8xl font-playfair text-white leading-tight drop-shadow-lg">Madarsa Fathul Quran</h1>
                <!-- === KEYWORD ADD KAR DIYA HAI === -->
                <p class="text-lg md:text-xl mt-4 max-w-2xl mx-auto text-text-light font-light">Ek markaz jahan ibadat se rooh ko, ilm se zehn ko, aur khidmat se muashray ko behtar banaya jata hai.</p>
                <button id="donate-now-hero-btn" class="btn-primary mt-10 inline-block">Donate Now</button> <!-- Changed to button to open modal -->
            </div>
        </section>

        <!-- Donation / Quranic Verse Section -->
        <section id="donate-verse" class="bg-custom-gold py-24 text-black fade-in-section">
            <div class="container mx-auto text-center px-4">
                <div class="flex flex-col items-center justify-center space-y-8">
                    <i class="fas fa-mosque text-6xl text-black"></i>
                    <p class="font-arabic text-3xl md:text-5xl leading-relaxed mb-6 font-semibold">
                        إِن تُقْرِضُوا اللَّهَ قَرْضًا حَسَنًا يُضَاعِفْهُ لَكُمْ وَيَغْفِرْ لَكُمْ ۗ وَاللَّهُ شَكُورٌ حَلِيمٌ
                    </p>
                    <p class="text-xl md:text-2xl max-w-3xl mx-auto mb-8 text-black">
                        اگر تم اللہ کو اچھا قرض دو گے تو وہ اسے تمہارے لیے کئی گنا بڑھا دے گا اور تمہیں معاف کرے گا۔ اللہ بڑا قدردان، بُردبار ہے۔" (سورة التغابن::17)
                    </p>
                    <button id="donate-now-verse-btn" class="btn-donate-now">Donate Now</button> <!-- Changed to button to open modal -->
                </div>
            </div>
        </section>

        <!-- About Us Section -->
        <section id="about" class="py-24 fade-in-section">
            <div class="container mx-auto px-4 grid md:grid-cols-2 gap-16 items-center">
                <div class="about-slideshow-frame mx-auto">
                    <div id="about-slideshow-container">
                        <!-- Slides will be injected here by JS -->
                    </div>
                </div>
                <div>
                    <h2 class="font-playfair text-4xl md:text-5xl mb-4"><span class="text-gold-gradient">Allah Helps Those Who Help Themselves</span></h2>
                    <!-- === KEYWORD ADD KAR DIYA HAI === -->
                    <p class="text-text-dark mb-6">
                        Madarsa Fathul Quran is dedicated to serving the community through faith, education, and outreach. Our mosque provides a welcoming space for all, encouraging spiritual growth, unity, and compassion.
                    </p>
                    <div class="flex flex-col sm:flex-row space-y-8 sm:space-y-0 sm:space-x-8 mb-8">
                        <div>
                            <i class="fas fa-eye vision-mission-icon text-2xl mb-2"></i>
                            <h3 class="font-semibold text-lg">Our Vision</h3>
                            <p class="text-sm text-text-dark">To create a vibrant center of faith and learning where Muslims of all backgrounds can grow together.</p>
                        </div>
                        <div>
                            <i class="fas fa-flag vision-mission-icon text-2xl mb-2"></i>
                            <h3 class="font-semibold text-lg">Our Mission</h3>
                            <p class="text-sm text-text-dark">To promote understanding, compassion, and social responsibility through community engagement.</p>
                        </div>
                    </div>

                    <!-- Donation Support Box -->
                    <div class="support-box flex flex-col md:flex-row items-center gap-6 mt-8 p-6 shadow-md rounded-lg">
                        <div class="flex-shrink-0">
                            <img src="https://i.postimg.cc/zBjZJJkT/d709ef989026ddf8f102671b48722831.jpg" alt="Young Muslim Boy" class="w-28 h-28 rounded-full object-cover border-4">
                        </div>
                        <div class="flex-grow text-center md:text-left">
                            <p class="text-base">Your support helps us to continue our community programs and outreach efforts.</p>
                        </div>
                        <div class="flex-shrink-0 text-center md:text-right">
                            <div class="text-4xl raised-amount font-bold leading-none">50,000</div>
                            <div class="text-2xl raised-amount font-bold leading-none">PKR</div>
                            <p class="text-sm mt-1">Raised</p>
                        </div>
                    </div>
                    
                    <!-- Program Categories -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-8">
                        <div class="program-item text-text-dark">
                            <i class="fas fa-check"></i> <span>Charity & Donation</span>
                        </div>
                        <div class="program-item text-text-dark">
                            <i class="fas fa-check"></i> <span>Hadith & Sunnah</span>
                        </div>
                        <div class="program-item text-text-dark">
                            <i class="fas fa-check"></i> <span>Parent Education</span>
                        </div>
                        <div class="program-item text-text-dark">
                            <i class="fas fa-check"></i> <span>Mosque Development</span>
                        </div>
                        <div class="program-item text-text-dark">
                            <i class="fas fa-check"></i> <span>Hifz Programs</span>
                        </div>
                        <div class="program-item text-text-dark">
                            <i class="fas fa-check"></i> <span>Tajweed Classes</span>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <!-- Our Activities Section -->
        <section id="activities" class="bg-dark-gray py-24 fade-in-section">
            <div class="container mx-auto text-center px-4">
                <h2 class="font-playfair text-4xl md:text-5xl mb-4 text-gold-gradient title-underline">Here Are Our Activities</h2>
                <p class="text-text-dark mb-16 max-w-2xl mx-auto">Discover the various programs and initiatives offered at Madarsa Fathul Quran, aimed at nurturing faith, knowledge, and community spirit.</p>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Activity Card 1: Mosque Development -->
                    <div class="glass-card p-6 rounded-lg text-center flex flex-col justify-between">
                        <div class="mb-4">
                            <i class="fas fa-mosque text-5xl text-gold mb-3"></i>
                            <h3 class="text-xl font-semibold mb-2 text-gold">Mosque Development</h3>
                            <p class="text-text-light text-sm">We are constantly working towards the expansion and improvement of the mosque facilities to better serve our growing community, ensuring that it remains a welcoming and accessible place for all.</p>
                        </div>
                    </div>
                    <!-- Activity Card 2: Charity & Donation -->
                    <div class="glass-card p-6 rounded-lg text-center flex flex-col justify-between">
                        <div class="mb-4">
                            <i class="fas fa-hand-holding-dollar text-5xl text-gold mb-3"></i>
                            <h3 class="text-xl font-semibold mb-2 text-gold">Charity & Donation</h3>
                            <p class="text-text-light text-sm">Our charity initiatives aim to support those in need, both locally and globally. Through donations, we provide relief to families, fund educational projects, and extend a helping hand to vulnerable individuals.</p>
                        </div>
                    </div>
                    <!-- Activity Card 3: Quran Learning -->
                    <div class="glass-card p-6 rounded-lg text-center flex flex-col justify-between">
                        <div class="mb-4">
                            <i class="fas fa-book-open text-5xl text-gold mb-3"></i>
                            <h3 class="text-xl font-semibold mb-2 text-gold">Quran Learning</h3>
                            <p class="text-text-light text-sm">Join our Quran learning classes, where students of all ages can study the Holy Quran, improve recitation, and deepen their understanding of its teachings under the guidance of experienced instructors.</p>
                        </div>
                    </div>
                    <!-- Activity Card 4: Hadith & Sunnah -->
                    <div class="glass-card p-6 rounded-lg text-center flex flex-col justify-between">
                        <div class="mb-4">
                            <i class="fas fa-book text-5xl text-gold mb-3"></i>
                            <h3 class="text-xl font-semibold mb-2 text-gold">Hadith & Sunnah</h3>
                            <p class="text-text-light text-sm">We offer regular sessions on Hadith and the Sunnah of Prophet Muhammad (PBUH), aiming to strengthen our community's understanding and practice of these essential aspects of Islam.</p>
                        </div>
                    </div>
                    <!-- Activity Card 5: Parent Education -->
                    <div class="glass-card p-6 rounded-lg text-center flex flex-col justify-between">
                        <div class="mb-4">
                            <i class="fas fa-user-graduate text-5xl text-gold mb-3"></i>
                            <h3 class="text-xl font-semibold mb-2 text-gold">Parent Education</h3>
                            <p class="text-text-light text-sm">We provide educational programs for parents to equip them with the knowledge and skills to raise their children with strong Islamic values in today's world.</p>
                        </div>
                    </div>
                    <!-- Activity Card 6: Help Orphans -->
                    <div class="glass-card p-6 rounded-lg text-center flex flex-col justify-between">
                        <div class="mb-4">
                            <i class="fas fa-hands-helping text-5xl text-gold mb-3"></i>
                            <h3 class="text-xl font-semibold mb-2 text-gold">Help Orphans</h3>
                            <p class="text-text-light text-sm">Through our orphan support programs, we are committed to providing care, education, and resources to orphaned children, ensuring they have a bright and hopeful future.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- =========================================== -->
        <!-- ===== NEW SECTION: OUR TEAM STARTS HERE ===== -->
        <!-- =========================================== -->
        <section id="team" class="py-24 fade-in-section">
            <div class="container mx-auto text-center px-4">
                <h2 class="font-playfair text-4xl md:text-5xl mb-4 text-gold-gradient title-underline">Our Team</h2>
                <p class="text-text-dark mb-16 max-w-2xl mx-auto">Meet the dedicated individuals who serve our community.</p>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                    <!-- Example Team Member 1 -->
                    <div class="team-card p-6 rounded-lg text-center shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                        <img src="https://via.placeholder.com/150/C5B358/000000?text=Maulana" alt="Maulana Sahib" class="w-32 h-32 rounded-full mx-auto mb-4 object-cover border-4 border-gold">
                        <h3 class="text-xl font-semibold text-gold-gradient mb-1">Maulana Muhammad Ali</h3>
                        <p class="text-text-dark text-sm mb-3">Imam & Quran Teacher</p>
                        <p class="text-text-light text-sm">Specializes in Tajweed and Hifz, guiding students with profound knowledge.</p>
                    </div>
                    <!-- Example Team Member 2 -->
                    <div class="team-card p-6 rounded-lg text-center shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                        <img src="https://via.placeholder.com/150/C5B358/000000?text=Ustadha" alt="Ustadha Ayesha" class="w-32 h-32 rounded-full mx-auto mb-4 object-cover border-4 border-gold">
                        <h3 class="text-xl font-semibold text-gold-gradient mb-1">Ustadha Fatima Khan</h3>
                        <p class="text-text-dark text-sm mb-3">Islamic Studies Educator</p>
                        <p class="text-text-light text-sm">Dedicated to teaching Fiqh and Hadith to young learners and adults.</p>
                    </div>
                    <!-- Example Team Member 3 -->
                    <div class="team-card p-6 rounded-lg text-center shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                        <img src="https://via.placeholder.com/150/C5B358/000000?text=Community" alt="Community Coordinator" class="w-32 h-32 rounded-full mx-auto mb-4 object-cover border-4 border-gold">
                        <h3 class="text-xl font-semibold text-gold-gradient mb-1">Mr. Ahmed Raza</h3>
                        <p class="text-text-dark text-sm mb-3">Community Outreach Coordinator</p>
                        <p class="text-text-light text-sm">Manages community events and facilitates interfaith dialogue.</p>
                    </div>
                    <!-- Example Team Member 4 -->
                    <div class="team-card p-6 rounded-lg text-center shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                        <img src="https://via.placeholder.com/150/C5B358/000000?text=Admin" alt="Admin Staff" class="w-32 h-32 rounded-full mx-auto mb-4 object-cover border-4 border-gold">
                        <h3 class="text-xl font-semibold text-gold-gradient mb-1">Ms. Samina Pervez</h3>
                        <p class="text-text-dark text-sm mb-3">Administrative Staff</p>
                        <p class="text-text-light text-sm">Ensures smooth daily operations and student registration processes.</p>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- =========================================== -->
        <!-- ===== NEW SECTION: OUR TEAM ENDS HERE ===== -->
        <!-- =========================================== -->
        
        <!-- Gallery Section -->
        <section id="customer-gallery" class="py-24 fade-in-section">
            <div class="container mx-auto text-center px-4">
                <h2 class="font-playfair text-4xl md:text-5xl mb-4 text-gold-gradient title-underline">Our Students & Activities</h2>
                <p class="text-text-dark mb-12 max-w-2xl mx-auto">A glimpse into the vibrant learning environment and community events at Madarsa Fathul Quran.</p>
                
                <div id="filter-buttons" class="flex justify-center flex-wrap gap-4 mb-12">
                    <!-- Filter buttons might not be needed if gallery content changes, but keeping for now -->
                    <button class="filter-btn active" data-filter="all">All</button>
                    <!-- <button class="filter-btn" data-filter="quran-classes">Quran Classes</button>
                    <button class="filter-btn" data-filter="community-events">Community Events</button>
                    <button class="filter-btn" data-filter="hifz-students">Hifz Students</button> -->
                </div>

                <div id="gallery-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 md:gap-6">
                    <!-- Images will be loaded from Firestore here -->
                </div>
            </div>
        </section>
        

        <!-- ======================================== -->
        <!-- ===== NEW SECTION: BLOG STARTS HERE ==== -->
        <!-- ======================================== -->
        <section id="blog" class="py-24 fade-in-section">
            <div class="container mx-auto text-center px-4">
                <h2 class="font-playfair text-4xl md:text-5xl mb-4 text-gold-gradient title-underline">From Our Blog</h2>
                <p class="text-text-dark mb-16 max-w-2xl mx-auto">Latest insights, Islamic teachings, and updates from Madarsa Fathul Quran.</p>
                <div id="blog-posts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto">
                    <!-- Blog posts will be loaded from Firestore here -->
                </div>
            </div>
        </section>
        <!-- ====================================== -->
        <!-- ===== NEW SECTION: BLOG ENDS HERE ==== -->
        <!-- ====================================== -->

        <!-- Contact Section -->
        <section id="contact" class="py-24 fade-in-section">
            <div class="container mx-auto text-center px-4">
                <h2 class="font-playfair text-4xl md:text-5xl mb-4 text-gold-gradient title-underline">Get In Touch</h2>
                <!-- === KEYWORD ADD KAR DIYA HAI === -->
                <p class="text-text-dark mb-12 max-w-2xl mx-auto">Have questions about admissions, donations, or general inquiries? Contact us today for guidance and support!</p>
                <div class="max-w-4xl mx-auto glass-card p-10 rounded-lg">
                    <div class="grid md:grid-cols-3 gap-8 mb-8">
                        <div id="contact-call-us" class="text-center"><i class="fas fa-phone-alt text-gold text-3xl mb-3"></i><h3 class="text-xl font-semibold">Call Us</h3><a href="tel:+923346541364" class="text-text-dark hover:text-gold">+92 334 6541364</a></div>
                        <div class="text-center"><i class="fas fa-map-marker-alt text-gold text-3xl mb-3"></i><h3 class="text-xl font-semibold">Visit Us</h3><p class="text-text-dark">Madrasa Fathul Quran Mansoor Abad nazad Imam Bargah</p></div>
                        <div class="text-center"><i class="fab fa-whatsapp text-gold text-3xl mb-3"></i><h3 class="text-xl font-semibold">WhatsApp</h3><a href="https://wa.me/923346541364" target="_blank" class="text-text-dark hover:text-gold">Message Us</a></div>
                    </div>
                    <div class="w-full h-80 rounded-lg overflow-hidden border-2 border-gold/50">
                        <!-- Updated map to new Madrasa Fathul Quran location -->
                        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3404.283029982361!2d73.1132963!3d31.4296773!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3922690015f9c3c3%3A0xb05f40777764d4db!2sMadrasa%20Fathul%20Quran%20mansoorabad!5e0!3m2!1sen!2s!4v1721382400000!5m2!1sen!2s" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                    </div>
                </div>
            </div>
        </section>
    </main>
    
    <!-- Footer -->
    <footer class="bg-dark-gray py-8">
        <div class="container mx-auto text-center text-text-dark">
            <div class="flex justify-center space-x-6 my-4">
                <!-- Replace with Madarsa's social media links or remove if not applicable -->
                <a href="https://www.instagram.com/your_madarsa_instagram" target="_blank" class="text-gold hover:text-white transition"><i class="fab fa-instagram fa-lg"></i></a>
                <a href="https://www.facebook.com/your_madarsa_facebook" target="_blank" class="text-gold hover:text-white transition"><i class="fab fa-facebook fa-lg"></i></a>
                <a href="https://www.tiktok.com/@your_madarsa_tiktok" target="_blank" class="text-gold hover:text-white transition"><i class="fab fa-tiktok fa-lg"></i></a>
            </div>
            <p class="text-sm">© 2024 Jamia Masjid Maryam & Madarsa Fathul Quran. All rights reserved. <i class="fas fa-mosque text-gold"></i></p>
            <!-- NEW: Design and Developed By line -->
            <p class="text-sm mt-2">© Design and Developed By <a href="https://www.facebook.com/naumanrasool786" target="_blank" style="color: var(--gold); text-decoration: none;">Asan Webs</a></p>
            <div class="mt-4">
                <button id="admin-login-btn" class="text-gold/50 hover:text-gold transition" title="Admin Panel">
                    <i class="fas fa-lock"></i> Admin Login
                </button>
                <button id="admin-logout-btn" class="hidden text-red-500/70 hover:text-red-500 transition ml-4" title="Admin Logout">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>
    </footer>

    <!-- Removed Contact/Inquiry Modal for now as per previous instruction.
         If you need a general inquiry form, let me know, and I'll add it back separately. -->

    <!-- NEW: Donation Details Modal -->
    <div id="donation-details-modal" class="modal-overlay">
        <div class="modal-content text-center">
            <h3 class="text-3xl font-playfair text-gold-gradient mb-6">Donation Details</h3>
            <p class="text-text-light mb-4">Please find the bank details below for your generous donations:</p>
            <div class="text-left space-y-2 text-text-light">
                <p><strong>Bank Name:</strong> Jazz Cash</p>
                <p><strong>Account Title:</strong> MUHAMMAD HAMMAD</p>
                <p><strong>Account Number:</strong> 03346541364</p>
            </div>
            <button id="close-donation-modal-btn" class="btn-primary mt-8 w-full">Close</button>
        </div>
    </div>


    <!-- Admin Login Modal -->
    <div id="login-modal" class="modal-overlay">
        <div class="modal-content text-center">
            <h3 class="text-2xl font-playfair text-gold-gradient mb-4">Admin Login</h3>
            <form id="login-form" class="space-y-4">
                <div>
                    <label for="login-email" class="sr-only">Email</label>
                    <input type="email" id="login-email" required placeholder="Enter Email" class="text-center">
                </div>
                <div>
                    <label for="login-password" class="sr-only">Password</label>
                    <input type="password" id="login-password" required placeholder="Enter Password" class="text-center">
                </div>
                <p id="login-error" class="text-red-500 text-sm h-5 mb-2"></p>
                <button type="submit" class="btn-primary w-full">Login</button>
            </form>
        </div>
    </div>

    <!-- Admin Panel Modal -->
    <div id="admin-panel-modal" class="modal-overlay">
        <div class="modal-content text-center">
            <h3 class="text-2xl font-playfair text-gold-gradient mb-6">Admin Panel</h3>
            <div class="space-y-4">
                <button id="upload-new-btn" class="btn-primary w-full">Upload New Content</button>
                <button id="manage-images-btn" class="btn-primary w-full bg-red-600 border-red-600 hover:bg-transparent hover:text-red-500">Manage Content</button>
            </div>
        </div>
    </div>

    <!-- Image Upload Modal -->
    <div id="upload-modal" class="modal-overlay">
        <div class="modal-content text-center">
            <h3 class="text-2xl font-playfair text-gold-gradient mb-4">Upload New Content</h3>
            <form id="upload-form">
                <div class="mb-4">
                    <label for="upload-destination" class="block text-left mb-2 text-text-dark">Upload To:</label>
                    <select id="upload-destination" required>
                        <option value="clients-gallery">Our Students & Activities (Gallery)</option>
                        <option value="story-slideshow">About Us Section</option>
                        <option value="hero-slideshow">Hero Section</option>
                        <option value="blog-post">Blog Post</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label for="image-file" class="block text-left mb-2 text-text-dark">Select Image File:</label>
                    <input type="file" id="image-file" accept="image/*" required>
                </div>
                <!-- Wrapper for Gallery-specific options -->
                <div id="gallery-options-wrapper" class="mb-6 space-y-4">
                    <label for="image-category" class="block text-left mb-2 text-text-dark">Select Category:</label>
                    <select id="image-category" required>
                        <option value="quran-classes">Quran Classes</option>
                        <option value="community-events">Community Events</option>
                        <option value="hifz-students">Hifz Students</option>
                        <option value="general">General</option> <!-- Added general category -->
                    </select>
                </div>
                <!-- Wrapper for Blog-specific options (initially hidden) -->
                <div id="blog-options-wrapper" class="hidden mb-6 space-y-4">
                     <div>
                        <label for="blog-title" class="block text-left mb-2 text-text-dark">Blog Title:</label>
                        <input type="text" id="blog-title" placeholder="Blog post ka title likhein">
                    </div>
                    <div>
                        <label for="blog-content" class="block text-left mb-2 text-text-dark">Blog Content:</label>
                        <textarea id="blog-content" rows="6" placeholder="Poori blog post yahan likhein"></textarea>
                    </div>
                </div>
                <button type="submit" class="btn-primary w-full" id="upload-submit-btn">Upload</button>
            </form>
        </div>
    </div>
    
    <!-- NEW: Blog Post Display Modal -->
    <div id="blog-post-modal" class="modal-overlay">
        <div class="modal-content relative">
             <button id="close-blog-modal-btn" class="absolute top-4 right-5 text-2xl text-text-dark hover:text-gold">&times;</button>
            <h3 id="blog-post-modal-title" class="text-3xl lg:text-4xl font-playfair text-gold-gradient mb-6 text-center"></h3>
            <img id="blog-post-modal-image" src="" alt="Blog Post Image" class="mb-6 mx-auto">
            <p id="blog-post-modal-content" class="text-text-light"></p>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Access Firebase instances and functions from global scope
            const db = window.firebaseFirestore;
            const auth = window.firebaseAuth;
            const signInWithEmailAndPassword = window.firebaseSignInWithEmailAndPassword;
            const signOut = window.firebaseSignOut;
            const onAuthStateChanged = window.firebaseOnAuthStateChanged;
            const addDoc = window.firebaseFirestore.addDoc;
            const collection = window.firebaseFirestore.collection;
            const getDocs = window.firebaseFirestore.getDocs;
            const query = window.firebaseFirestore.query;
            const deleteDoc = window.firebaseFirestore.deleteDoc;
            const doc = window.firebaseFirestore.doc;
            const orderBy = window.firebaseFirestore.orderBy; // Get orderBy

            // Cloudinary Credentials
            const CLOUDINARY_CLOUD_NAME = 'dtacwfyx2'; // Replace with your Cloudinary Cloud Name
            const CLOUDINARY_UPLOAD_PRESET = 'quiffcuts_preset'; // Replace with your Cloudinary Upload Preset

            // --- Hero Section Slideshow ---
            const heroSection = document.querySelector('.hero-section');
            let heroImages = [];
            let currentHeroImageIndex = 0;
            let heroSlideshowInterval;

            async function loadHeroImages() {
                try {
                    const heroSnapshot = await getDocs(query(collection(db, "heroImages"), orderBy("timestamp", "desc")));
                    heroImages = heroSnapshot.docs.map(doc => `url(${doc.data().url})`);
                    if (heroImages.length === 0) throw new Error("No hero images in Firestore");
                    initializeHeroSlideshow();
                } catch (error) {
                    console.error("Error/Fallback hero images:", error);
                    heroImages = [
                        'url(https://i.postimg.cc/Jzn0DzY7/1.jpg)',
                        'url(https://i.postimg.cc/Y2ssKncX/kel-avelino-y-LW1yz-CK2-HY-unsplash.jpg)'
                    ];
                    initializeHeroSlideshow();
                }
            }

            function initializeHeroSlideshow() {
                if (heroSlideshowInterval) clearInterval(heroSlideshowInterval);
                if (heroImages.length > 0) {
                    heroImages.forEach(src => { new Image().src = src.replace(/url\((['"])?(.*?)\1\)/gi, '$2'); });
                    heroSection.style.backgroundImage = heroImages[currentHeroImageIndex];
                    heroSlideshowInterval = setInterval(() => {
                        currentHeroImageIndex = (currentHeroImageIndex + 1) % heroImages.length;
                        heroSection.style.backgroundImage = heroImages[currentHeroImageIndex];
                    }, 5000);
                }
            }
            loadHeroImages();

            // --- About Us Slideshow ---
            const aboutSlideshowContainer = document.getElementById('about-slideshow-container');
            let aboutImagesData = [];
            let currentAboutSlideIndex = 0;
            let aboutSlideshowInterval;

            async function loadAboutImages() {
                try {
                    const aboutSnapshot = await getDocs(query(collection(db, "aboutImages"), orderBy("timestamp", "desc")));
                    aboutImagesData = aboutSnapshot.docs.map(doc => ({ url: doc.data().url, docId: doc.id }));
                     if (aboutImagesData.length === 0) throw new Error("No about images in Firestore");
                    initializeAboutSlideshow();
                } catch (error) {
                    console.error("Error/Fallback about images:", error);
                    aboutImagesData = [
                        { url: 'https://i.postimg.cc/P5VVtCZW/6.jpg', docId: 'default1' },
                        { url: 'https://i.postimg.cc/B6TC1b8w/5.jpg', docId: 'default2' }
                    ];
                    initializeAboutSlideshow();
                }
            }

            function initializeAboutSlideshow() {
                aboutSlideshowContainer.innerHTML = '';
                if (aboutImagesData.length === 0) {
                    if (aboutSlideshowInterval) clearInterval(aboutSlideshowInterval);
                    return;
                }
                aboutImagesData.forEach((imageData, index) => {
                    const wrapper = document.createElement('div');
                    wrapper.className = 'about-slide-wrapper';
                    wrapper.dataset.docId = imageData.docId;
                    wrapper.innerHTML = `<img src="${imageData.url}" class="about-slide">`;
                    aboutSlideshowContainer.appendChild(wrapper);
                });
                const aboutSlides = document.querySelectorAll('#about-slideshow-container .about-slide-wrapper');
                if (aboutSlideshowInterval) clearInterval(aboutSlideshowInterval);
                currentAboutSlideIndex = 0;
                if(aboutSlides.length > 0) aboutSlides[currentAboutSlideIndex].classList.add('active');
                aboutSlideshowInterval = setInterval(() => {
                    if(aboutSlides.length === 0) return;
                    aboutSlides[currentAboutSlideIndex].classList.remove('active');
                    currentAboutSlideIndex = (currentAboutSlideIndex + 1) % aboutSlides.length;
                    aboutSlides[currentAboutSlideIndex].classList.add('active');
                }, 5000);
                 if (document.body.classList.contains('delete-mode')) addDeleteIcons();
            }
            loadAboutImages();

            // --- Filterable Gallery ---
            const filterButtons = document.querySelectorAll('.filter-btn');
            const galleryGrid = document.getElementById('gallery-grid');
            let galleryImagesData = [];

            async function loadGalleryImages() {
                try {
                    const gallerySnapshot = await getDocs(query(collection(db, "galleryImages"), orderBy("timestamp", "desc")));
                    galleryImagesData = gallerySnapshot.docs.map(doc => ({ ...doc.data(), docId: doc.id }));
                    renderGallery();
                } catch (error) {
                    console.error("Error loading gallery images:", error);
                }
            }

            function renderGallery() {
                galleryGrid.innerHTML = '';
                const currentFilter = document.querySelector('.filter-btn.active')?.dataset.filter || 'all';
                const filteredData = galleryImagesData.filter(item => currentFilter === 'all' || item.category === currentFilter);

                filteredData.forEach(imageData => {
                    const newItem = document.createElement('div');
                    newItem.className = 'gallery-item';
                    newItem.dataset.category = imageData.category;
                    newItem.dataset.docId = imageData.docId;
                    newItem.innerHTML = `
                        <div class="gallery-card">
                            <div class="gallery-img-container"><img src="${imageData.url}" class="gallery-img"></div>
                        </div>`;
                    galleryGrid.appendChild(newItem);
                });
                if (document.body.classList.contains('delete-mode')) addDeleteIcons();
            }

            filterButtons.forEach(button => {
                button.addEventListener('click', () => {
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    renderGallery();
                });
            });
            loadGalleryImages();

            // --- NEW: Blog Section Logic ---
            const blogPostsGrid = document.getElementById('blog-posts-grid');
            const blogPostModal = document.getElementById('blog-post-modal');
            let blogPostsData = [];

            async function loadBlogPosts() {
                try {
                    const blogSnapshot = await getDocs(query(collection(db, "blogPosts"), orderBy("timestamp", "desc")));
                    blogPostsData = blogSnapshot.docs.map(doc => ({ ...doc.data(), docId: doc.id }));
                    renderBlogPosts();
                } catch (error) {
                    console.error("Error loading blog posts:", error);
                    blogPostsGrid.innerHTML = `<p class="text-text-dark col-span-full">Could not load blog posts. Please try again later.</p>`;
                }
            }
            
            function renderBlogPosts() {
                blogPostsGrid.innerHTML = '';
                if(blogPostsData.length === 0){
                    blogPostsGrid.innerHTML = `<p class="text-text-dark col-span-full">No blog posts yet. Stay tuned!</p>`;
                    return;
                }
                blogPostsData.forEach(postData => {
                    const postElement = document.createElement('div');
                    postElement.className = 'blog-card';
                    postElement.dataset.docId = postData.docId;
                    
                    // Create an excerpt
                    const excerpt = postData.content.split(' ').slice(0, 20).join(' ') + '...';

                    postElement.innerHTML = `
                        <div class="overflow-hidden"><img src="${postData.imageUrl}" alt="${postData.title}" class="blog-card-img"></div>
                        <div class="blog-card-content">
                            <h3 class="text-2xl font-bold mb-2 blog-card-title">${postData.title}</h3>
                            <p class="blog-card-excerpt mb-4">${excerpt}</p>
                            <button class="btn-secondary mt-auto self-start read-more-btn">Read More</button>
                        </div>
                    `;
                    blogPostsGrid.appendChild(postElement);
                });
                
                // Add event listeners to new "Read More" buttons
                document.querySelectorAll('.read-more-btn').forEach((button, index) => {
                    button.addEventListener('click', () => {
                        const post = blogPostsData[index];
                        document.getElementById('blog-post-modal-title').textContent = post.title;
                        document.getElementById('blog-post-modal-image').src = post.imageUrl;
                        document.getElementById('blog-post-modal-content').textContent = post.content;
                        blogPostModal.classList.add('visible');
                    });
                });

                if (document.body.classList.contains('delete-mode')) addDeleteIcons();
            }

            document.getElementById('close-blog-modal-btn').addEventListener('click', () => blogPostModal.classList.remove('visible'));
            blogPostModal.addEventListener('click', (e) => {
                if(e.target === blogPostModal) blogPostModal.classList.remove('visible');
            });
            
            loadBlogPosts(); // Load posts on page start


            // --- Mobile Menu ---
            document.getElementById('mobile-menu-btn').addEventListener('click', () => {
                document.getElementById('mobile-menu').classList.toggle('hidden');
            });

            // --- Scroll Animations ---
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) entry.target.classList.add('is-visible');
                });
            }, { threshold: 0.1 });
            document.querySelectorAll('.fade-in-section').forEach(section => observer.observe(section));

            // --- Donation Details Modal Logic ---
            const donationDetailsModal = document.getElementById('donation-details-modal');
            const closeDonationModalBtn = document.getElementById('close-donation-modal-btn');
            
            document.getElementById('donate-now-header-btn').addEventListener('click', () => {
                donationDetailsModal.classList.add('visible');
            });
            document.getElementById('donate-now-mobile-btn').addEventListener('click', () => {
                donationDetailsModal.classList.add('visible');
            });
            document.getElementById('donate-now-hero-btn').addEventListener('click', () => {
                donationDetailsModal.classList.add('visible');
            });
            document.getElementById('donate-now-verse-btn').addEventListener('click', () => {
                donationDetailsModal.classList.add('visible');
            });

            closeDonationModalBtn.addEventListener('click', () => {
                donationDetailsModal.classList.remove('visible');
            });
            donationDetailsModal.addEventListener('click', (e) => {
                if (e.target === donationDetailsModal) {
                    donationDetailsModal.classList.remove('visible');
                }
            });


            // --- Admin Panel & Authentication Logic ---
            const adminLoginBtn = document.getElementById('admin-login-btn');
            const adminLogoutBtn = document.getElementById('admin-logout-btn');
            const loginModal = document.getElementById('login-modal');
            const adminPanelModal = document.getElementById('admin-panel-modal');
            const uploadModal = document.getElementById('upload-modal');
            const uploadForm = document.getElementById('upload-form');
            const uploadDestination = document.getElementById('upload-destination');
            const galleryOptionsWrapper = document.getElementById('gallery-options-wrapper');
            const blogOptionsWrapper = document.getElementById('blog-options-wrapper');
            const manageImagesBtn = document.getElementById('manage-images-btn');
            const finishManagingBtn = document.getElementById('finish-managing-btn');
            
            // Auth state change listener
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    adminLoginBtn.classList.add('hidden');
                    adminLogoutBtn.classList.remove('hidden');
                } else {
                    adminLoginBtn.classList.remove('hidden');
                    adminLogoutBtn.classList.add('hidden');
                    // Hide all admin modals and modes on logout
                    [adminPanelModal, uploadModal, loginModal].forEach(modal => modal.classList.remove('visible'));
                    document.body.classList.remove('delete-mode');
                    finishManagingBtn.classList.add('hidden');
                }
            });

            adminLoginBtn.addEventListener('click', () => loginModal.classList.add('visible'));
            loginModal.addEventListener('click', (e) => { if(e.target === loginModal) loginModal.classList.remove('visible'); });
            
            document.getElementById('login-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = document.getElementById('login-email').value;
                const password = document.getElementById('login-password').value;
                try {
                    await signInWithEmailAndPassword(auth, email, password);
                    loginModal.classList.remove('visible');
                    adminPanelModal.classList.add('visible');
                    document.getElementById('login-error').textContent = '';
                } catch (error) {
                    document.getElementById('login-error').textContent = "Invalid email or password.";
                }
            });

            adminLogoutBtn.addEventListener('click', () => signOut(auth));

            adminPanelModal.addEventListener('click', (e) => { if (e.target === adminPanelModal) adminPanelModal.classList.remove('visible'); });
            uploadModal.addEventListener('click', (e) => { if (e.target === uploadModal) uploadModal.classList.remove('visible'); });

            document.getElementById('upload-new-btn').addEventListener('click', () => {
                adminPanelModal.classList.remove('visible');
                uploadForm.reset();
                uploadDestination.dispatchEvent(new Event('change')); // Trigger change to set correct initial view
                uploadModal.classList.add('visible');
            });

            // NEW logic to show/hide admin form fields
            uploadDestination.addEventListener('change', () => {
                const isBlog = uploadDestination.value === 'blog-post';
                blogOptionsWrapper.classList.toggle('hidden', !isBlog);
                galleryOptionsWrapper.classList.toggle('hidden', isBlog);
                
                document.getElementById('blog-title').required = isBlog;
                document.getElementById('blog-content').required = isBlog;
                document.getElementById('image-category').required = !isBlog;
            });

            // Handle form submission for ALL content types
            uploadForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const uploadSubmitButton = document.getElementById('upload-submit-btn');
                uploadSubmitButton.textContent = 'Uploading...';
                uploadSubmitButton.disabled = true;

                const file = document.getElementById('image-file').files[0];
                const destination = uploadDestination.value;
                if (!file) {
                    alert('Please select an image file.');
                    uploadSubmitButton.textContent = 'Upload';
                    uploadSubmitButton.disabled = false;
                    return;
                }

                try {
                    // Upload to Cloudinary
                    const formData = new FormData();
                    formData.append('file', file);
                    formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);
                    const response = await fetch(`https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/image/upload`, { method: 'POST', body: formData });
                    if (!response.ok) throw new Error('Cloudinary upload failed');
                    const data = await response.json();
                    
                    let collectionName = '';
                    let docData = {};

                    if (destination === 'blog-post') {
                        collectionName = "blogPosts";
                        docData = {
                            title: document.getElementById('blog-title').value,
                            content: document.getElementById('blog-content').value,
                            imageUrl: data.secure_url,
                            publicId: data.public_id,
                            timestamp: new Date().toISOString()
                        };
                        await addDoc(collection(db, collectionName), docData);
                        loadBlogPosts(); // Refresh blog posts
                    } else { // Handle gallery, hero, about
                        if (destination === 'clients-gallery') {
                            collectionName = "galleryImages";
                            docData = { url: data.secure_url, category: document.getElementById('image-category').value, publicId: data.public_id, timestamp: new Date().toISOString() };
                            await addDoc(collection(db, collectionName), docData);
                            loadGalleryImages();
                        } else if (destination === 'story-slideshow') {
                            collectionName = "aboutImages";
                            docData = { url: data.secure_url, publicId: data.public_id, timestamp: new Date().toISOString() };
                             await addDoc(collection(db, collectionName), docData);
                            loadAboutImages();
                        } else if (destination === 'hero-slideshow') {
                            collectionName = "heroImages";
                             docData = { url: data.secure_url, publicId: data.public_id, timestamp: new Date().toISOString() };
                             await addDoc(collection(db, collectionName), docData);
                            loadHeroImages();
                        }
                    }
                    
                    uploadModal.classList.remove('visible');
                    alert('Content uploaded successfully!');

                } catch (error) {
                    console.error("Upload Error: ", error);
                    alert('Upload failed. Please check console for details.');
                } finally {
                    uploadSubmitButton.textContent = 'Upload';
                    uploadSubmitButton.disabled = false;
                }
            });


            // --- Delete Mode Logic ---
            manageImagesBtn.addEventListener('click', () => {
                adminPanelModal.classList.remove('visible');
                document.body.classList.add('delete-mode');
                finishManagingBtn.classList.remove('hidden');
                addDeleteIcons();
            });

            finishManagingBtn.addEventListener('click', () => {
                document.body.classList.remove('delete-mode');
                finishManagingBtn.classList.add('hidden');
                // Re-render sections to remove delete icons
                renderGallery();
                initializeAboutSlideshow();
                renderBlogPosts();
            });

            function addDeleteIcons() {
                // Gallery items
                document.querySelectorAll('#gallery-grid .gallery-item').forEach(item => {
                    if (item.querySelector('.delete-icon')) return;
                    const deleteBtn = createDeleteButton(() => handleDelete('galleryImages', item.dataset.docId, loadGalleryImages));
                    item.querySelector('.gallery-card').appendChild(deleteBtn);
                });
                
                // About slideshow
                document.querySelectorAll('#about-slideshow-container .about-slide-wrapper').forEach(wrapper => {
                     if (wrapper.querySelector('.delete-icon')) return;
                    const deleteBtn = createDeleteButton(() => handleDelete('aboutImages', wrapper.dataset.docId, loadAboutImages));
                    wrapper.appendChild(deleteBtn);
                });
                
                // Blog Posts
                document.querySelectorAll('#blog-posts-grid .blog-card').forEach(card => {
                     if (card.querySelector('.delete-icon')) return;
                    const deleteBtn = createDeleteButton(() => handleDelete('blogPosts', card.dataset.docId, loadBlogPosts));
                    card.appendChild(deleteBtn);
                });
            }

            function createDeleteButton(onClick) {
                const deleteBtn = document.createElement('span');
                deleteBtn.className = 'delete-icon';
                deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
                deleteBtn.onclick = (e) => {
                    e.stopPropagation();
                    e.preventDefault();
                    showCustomConfirm('Are you sure you want to delete this item?', onClick);
                };
                return deleteBtn;
            }

            async function handleDelete(collectionName, docId, refreshFunction) {
                 if (docId.startsWith('default')) { // Prevent deleting fallback images
                    alert("This is a default item and cannot be deleted.");
                    return;
                }
                try {
                    await deleteDoc(doc(db, collectionName, docId));
                    alert("Item removed successfully.");
                    refreshFunction(); // Refresh the relevant section
                } catch (error) {
                    console.error("Error removing document:", error);
                    alert("Error removing item.");
                }
            }

            // --- Custom Confirm Modal ---
            function showCustomConfirm(message, onConfirm) {
                const existingModal = document.getElementById('custom-confirm-modal');
                if (existingModal) existingModal.remove();

                const modalHtml = `
                    <div id="custom-confirm-modal" class="modal-overlay visible">
                        <div class="modal-content text-center">
                            <h3 class="2xl font-playfair text-gold-gradient mb-4">Confirm Action</h3>
                            <p class="text-text-light mb-6">${message}</p>
                            <div class="flex justify-center gap-4">
                                <button id="confirm-yes-btn" class="btn-primary">Yes</button>
                                <button id="confirm-no-btn" class="btn-secondary">No</button>
                            </div>
                        </div>
                    </div>
                `;
                document.body.insertAdjacentHTML('beforeend', modalHtml);

                const modal = document.getElementById('custom-confirm-modal');
                document.getElementById('confirm-yes-btn').onclick = () => { onConfirm(); modal.remove(); };
                document.getElementById('confirm-no-btn').onclick = () => modal.remove();
                modal.addEventListener('click', (e) => { if (e.target === modal) modal.remove(); });
            }
        });
    </script>

</body>
</html>



